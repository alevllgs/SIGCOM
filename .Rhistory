#         if(b %in% SIGFE$SIGCOM){
#           GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#             summarise(Devengado = sum(Devengado)) %>%
#             filter(SIGCOM == b)
#           GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
#                                    Devengado = Devengado*M2$prop,
#                                    "Cuenta"=b, "Tipo" = -1)
#           GG1 <- rbind(GG1,GG2)}
#
# b <- "41-PRODUCTOS QUÍMICOS"
# if(b %in% SIGFE$SIGCOM & b %in% CxCC$ItemxCC){
#   CCC <- CxCC %>% filter(ItemxCC == b) %>%
#     select(CC, Total) %>%
#     group_by (CC) %>%
#     summarise(Total =sum(Total)) %>%
#     mutate("prop" = Total/sum(Total))
#   GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#     summarise(Devengado = sum(Devengado)) %>%
#     filter(SIGCOM == b)
#   GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                            Devengado = Devengado*CCC$prop,
#                            "Cuenta"=b, "Tipo" = 0)
#   GG1 <- rbind(GG1,GG2)} else
#     if(b %in% SIGFE$SIGCOM & b %in% CxCC_H$ItemxCC){
#       CCC <- CxCC_H %>% filter(ItemxCC == b) %>%
#         select(CC, Total) %>%
#         group_by (CC) %>%
#         summarise(Total =sum(Total)) %>%
#         mutate("prop" = Total/sum(Total))
#       GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#         summarise(Devengado = sum(Devengado)) %>%
#         filter(SIGCOM == b)
#       GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                                Devengado = Devengado*CCC$prop,
#                                "Cuenta"=b, "Tipo" = 6)
#       GG1 <- rbind(GG1,GG2)} else
#         if(b %in% SIGFE$SIGCOM){
#           GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#             summarise(Devengado = sum(Devengado)) %>%
#             filter(SIGCOM == b)
#           GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
#                                    Devengado = Devengado*M2$prop,
#                                    "Cuenta"=b, "Tipo" = -1)
#           GG1 <- rbind(GG1,GG2)}
#
# b <- "43-PRODUCTOS TEXTILES, VESTUARIO Y CALZADO"
# if(b %in% SIGFE$SIGCOM & b %in% CxCC$ItemxCC){
#   CCC <- CxCC %>% filter(ItemxCC == b) %>%
#     select(CC, Total) %>%
#     group_by (CC) %>%
#     summarise(Total =sum(Total)) %>%
#     mutate("prop" = Total/sum(Total))
#   GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#     summarise(Devengado = sum(Devengado)) %>%
#     filter(SIGCOM == b)
#   GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                            Devengado = Devengado*CCC$prop,
#                            "Cuenta"=b, "Tipo" = 0)
#   GG1 <- rbind(GG1,GG2)} else
#     if(b %in% SIGFE$SIGCOM & b %in% CxCC_H$ItemxCC){
#       CCC <- CxCC_H %>% filter(ItemxCC == b) %>%
#         select(CC, Total) %>%
#         group_by (CC) %>%
#         summarise(Total =sum(Total)) %>%
#         mutate("prop" = Total/sum(Total))
#       GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#         summarise(Devengado = sum(Devengado)) %>%
#         filter(SIGCOM == b)
#       GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                                Devengado = Devengado*CCC$prop,
#                                "Cuenta"=b, "Tipo" = 6)
#       GG1 <- rbind(GG1,GG2)} else
#         if(b %in% SIGFE$SIGCOM){
#           GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#             summarise(Devengado = sum(Devengado)) %>%
#             filter(SIGCOM == b)
#           GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
#                                    Devengado = Devengado*M2$prop,
#                                    "Cuenta"=b, "Tipo" = -1)
#           GG1 <- rbind(GG1,GG2)}
#
# b <- "44-REPUESTOS Y ACCESORIOS PARA MANTENIMIENTO Y REPARACIONES DE VEHICULOS"
# if(b %in% SIGFE$SIGCOM & b %in% CxCC$ItemxCC){
#   CCC <- CxCC %>% filter(ItemxCC == b) %>%
#     select(CC, Total) %>%
#     group_by (CC) %>%
#     summarise(Total =sum(Total)) %>%
#     mutate("prop" = Total/sum(Total))
#   GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#     summarise(Devengado = sum(Devengado)) %>%
#     filter(SIGCOM == b)
#   GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                            Devengado = Devengado*CCC$prop,
#                            "Cuenta"=b, "Tipo" = 0)
#   GG1 <- rbind(GG1,GG2)} else
#     if(b %in% SIGFE$SIGCOM & b %in% CxCC_H$ItemxCC){
#       CCC <- CxCC_H %>% filter(ItemxCC == b) %>%
#         select(CC, Total) %>%
#         group_by (CC) %>%
#         summarise(Total =sum(Total)) %>%
#         mutate("prop" = Total/sum(Total))
#       GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#         summarise(Devengado = sum(Devengado)) %>%
#         filter(SIGCOM == b)
#       GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                                Devengado = Devengado*CCC$prop,
#                                "Cuenta"=b, "Tipo" = 6)
#       GG1 <- rbind(GG1,GG2)} else
#         if(b %in% SIGFE$SIGCOM){
#           GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#             summarise(Devengado = sum(Devengado)) %>%
#             filter(SIGCOM == b)
#           GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
#                                    Devengado = Devengado*M2$prop,
#                                    "Cuenta"=b, "Tipo" = -1)
#           GG1 <- rbind(GG1,GG2)}
#
# b <- "46-VÍVERES"
# if(b %in% SIGFE$SIGCOM & b %in% CxCC$ItemxCC){
#   CCC <- CxCC %>% filter(ItemxCC == b) %>%
#     select(CC, Total) %>%
#     group_by (CC) %>%
#     summarise(Total =sum(Total)) %>%
#     mutate("prop" = Total/sum(Total))
#   GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#     summarise(Devengado = sum(Devengado)) %>%
#     filter(SIGCOM == b)
#   GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                            Devengado = Devengado*CCC$prop,
#                            "Cuenta"=b, "Tipo" = 0)
#   GG1 <- rbind(GG1,GG2)} else
#     if(b %in% SIGFE$SIGCOM & b %in% CxCC_H$ItemxCC){
#       CCC <- CxCC_H %>% filter(ItemxCC == b) %>%
#         select(CC, Total) %>%
#         group_by (CC) %>%
#         summarise(Total =sum(Total)) %>%
#         mutate("prop" = Total/sum(Total))
#       GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#         summarise(Devengado = sum(Devengado)) %>%
#         filter(SIGCOM == b)
#       GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
#                                Devengado = Devengado*CCC$prop,
#                                "Cuenta"=b, "Tipo" = 6)
#       GG1 <- rbind(GG1,GG2)} else
#         if(b %in% SIGFE$SIGCOM){
#           GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
#             summarise(Devengado = sum(Devengado)) %>%
#             filter(SIGCOM == b)
#           GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
#                                    Devengado = Devengado*M2$prop,
#                                    "Cuenta"=b, "Tipo" = -1)
#           GG1 <- rbind(GG1,GG2)}
# Centros de Costo Globales -----------------------------------------------
Compras_Servicios <- GG1 %>% filter (Cuenta == "65-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL INTERNO" |
Cuenta == "64-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL EXTERNO")
sum(Compras_Servicios$Devengado)
GG1 <- GG1 %>% filter (Cuenta != "65-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL INTERNO" &
Cuenta != "64-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL EXTERNO")
GG4 <- GG1 %>% filter (`Centro de Costo`== "Pabellón Prorratear")
GG3 <- GG1 %>% filter (`Centro de Costo`== "Cae Prorratear")
GG1 <- GG1 %>% filter(`Centro de Costo`!="Pabellón Prorratear" &
`Centro de Costo`!="Cae Prorratear")
#PABELLON
qx <- "464-QUIRÓFANOS CARDIOVASCULAR"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- GG2
qx <- "467-QUIRÓFANOS DIGESTIVA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "475-QUIRÓFANOS NEUROCIRUGÍA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "478-QUIRÓFANOS OFTALMOLOGÍA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "480-QUIRÓFANOS OTORRINOLARINGOLOGÍA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "485-QUIRÓFANOS TRAUMATOLOGÍA Y ORTOPEDIA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "486-QUIRÓFANOS UROLOGÍA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "493-QUIRÓFANOS CIRUGÍA PLÁSTICA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "495-QUIRÓFANOS CIRUGÍA VASCULAR"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "473-QUIRÓFANOS MENOR AMBULATORIA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
qx <- "471-QUIRÓFANOS MAYOR AMBULATORIA"
q <- sum(ifelse(M2Pab$CC == qx, M2Pab$prop, 0))
GG2 <- GG4 %>% filter(`Centro de Costo`=="Pabellón Prorratear") %>%
summarise("Centro de Costo" = qx,
Devengado = Devengado*q,
"Cuenta"= Cuenta,"Tipo" = 2)
GG44 <- rbind(GG44, GG2)
#AMBULATORIA
am <- "240-PROCEDIMIENTO DE CARDIOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- GG2
am <- "244-PROCEDIMIENTO DE NEUMOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "249-PROCEDIMIENTOS DE DERMATOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "250-PROCEDIMIENTOS DE GASTROENTEROLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "260-PROCEDIMIENTO ONCOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "261-PROCEDIMIENTOS DE OTORRINOLARINGOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "262-PROCEDIMIENTOS DE TRAUMATOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "269-PROCEDIMIENTOS DE NEUROLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "351-CONSULTA CIRUGÍA PEDIÁTRICA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "230-CONSULTA NUTRICIÓN"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "275-CONSULTA REUMATOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "276-CONSULTA CARDIOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "277-CONSULTA DERMATOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "280-CONSULTA PSIQUIATRÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "281-CONSULTA ENDOCRINOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "282-CONSULTA NEUMOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "284-CONSULTA INFECTOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "285-CONSULTA NEFROLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "286-CONSULTA GENÉTICA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "289-CONSULTA FISIATRÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "290-CONSULTA GASTROENTEROLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "292-CONSULTA NEUROCIRUGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "296-CONSULTA ANESTESIOLOGIA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "306-CONSULTA HEMATOLOGÍA ONCOLÓGICA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "311-CONSULTA UROLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "316-CONSULTA CIRUGÍA PLÁSTICA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "317-CONSULTA OFTALMOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "319-CONSULTA OTORRINOLARINGOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "328-CONSULTA PEDIATRÍA GENERAL"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "331-CONSULTA NEUROLOGÍA PEDIÁTRICA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "342-CONSULTA TRAUMATOLOGÍA PEDIÁTRICA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "353-CONSULTA GINECOLOGICA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "356-CONSULTA ODONTOLOGÍA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
am <- "359-TELEMEDICINA"
a <- sum(ifelse(CAE_prorratear$CC == am, CAE_prorratear$prop, 0))
GG2 <- GG3 %>% filter(`Centro de Costo`=="Cae Prorratear") %>%
summarise("Centro de Costo" = am,
Devengado = Devengado*a,
"Cuenta"= Cuenta,"Tipo" = 2)
GG33 <- rbind(GG33, GG2)
GG1 <- rbind(GG33,GG44,GG1)
#con esta formula puedo prorratear los que estan en
# CAE prorratear, hospitalizacion prorratear, pab prorratear y M2
#### Falta aplicar esta formula a:
#### Pabellón Prorratear
#### CAE Prorratear
#aca solo busca en sigfe (cuando hay devengo y no CxCC) y debo conectarlo
# con el CxCC Historial
#en el CxCC Historial debe incluir c/u de los Items presupuestarios
#estudiar los for
#Redondeo el Devengado
GG1 <- GG1 %>%  filter (Devengado != 0) %>%
summarise("Centro de Costo"= `Centro de Costo`,"Devengado" = round(Devengado),
"Cuenta"=Cuenta,"Tipo"=Tipo) %>%
ungroup()
GG1 <- GG1 %>% mutate(`Centro de Costo` = case_when(`Centro de Costo` ==	"478-QUIRÓFANOS OFTALMOLOGÍA"	~	"471-QUIRÓFANOS MAYOR AMBULATORIA",
`Centro de Costo` ==	"480-QUIRÓFANOS OTORRINOLARINGOLOGÍA"	~	"471-QUIRÓFANOS MAYOR AMBULATORIA",
`Centro de Costo` ==	"713-TRABAJO SOCIAL"	~	"99544-TRABAJO SOCIAL",
TRUE ~ `Centro de Costo`))
sum(SIGFE$Devengado)
SIGFE %>%  filter(Tipo != "Insumos") %>%
summarise(sum(Devengado))
sum(GG1$Devengado)
diferencia <- sum(SIGFE$Devengado)-sum(GG1$Devengado)-sum(Compras_Servicios$Devengado)
diferencia
openxlsx::write.xlsx(GG1, graba, colNames = TRUE, sheetName = "SIGFE", overwrite = TRUE)
rm(Farm, GG2, GG3, GG33, GG4, GG44, M2, M2Pab,
`471-QUIRÓFANOS MAYOR AMBULATORIA`, `473-QUIRÓFANOS MENOR AMBULATORIA`, a,
am, Cant_RRHH, ConsumoxCC, ggenerales, graba, insumos, M2_Pab_EqMed,
Metros_pabellon, q, qx, RRHH_sigfe, b, SIGFE2, GG1_nulo, cuentas,
cuentas_cae, cuentas_clinico, cuentas_qx, cuentas_total, EqMed, EqMedCorrec,
EqMedPrev, CAE_prorratear, Cant_RRHH, i, resto, ruta_base, mes_archivo, df, CxCC, CxCC_H, CCC)
sum(Compras_Servicios$Devengado)
