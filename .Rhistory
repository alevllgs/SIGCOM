GG1 <- rbind(GG1,GG2) %>% filter(Cuenta!="eliminar")}
}
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(dplyr)
library(openxlsx)
library(xlsx)
cuentas <- c("52-ARRENDAMIENTOS",
"60-COMPRA DE CAMAS AL EXTRA SISTEMA CAMAS NO CRÍTICAS",
"61-COMPRA DE CONSULTAS MÉDICAS",
"62-COMPRA DE CONSULTAS NO MÉDICAS",
"63-COMPRA DE INTERVENCIONES QUIRÚRGICAS CLÍNICAS",
"64-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL EXTERNO",
"65-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL INTERNO",
"66-COMPRA DE OTROS SERVICIOS",
"129-MANTENIMIENTO EQUIPO DE CÓMPUTO",
"131-MANTENIMIENTO MAQUINARIA Y EQUIPO",
"132-MANTENIMIENTO MUEBLES Y ENSERES",
"135-MANTENIMIENTO Y REPARACION DE VEHICULOS",
"147-OTROS MANTENIMIENTOS",
"151-PASAJES, FLETES Y BODEGAJE")
for (i in cuentas) {
if(i %in% SIGFE$SIGCOM & i %in% CxCC$ItemxCC){
CCC <- CxCC %>% filter(ItemxCC == i) %>%
select(CC, Total) %>%
group_by (CC) %>%
summarise(Total =sum(Total)) %>%
mutate("prop" = Total/sum(Total))
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
Devengado = Devengado*CCC$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)} else if
(i %in% SIGFE$SIGCOM & i %in% CxCC_H$ItemxCC){
CCC <- CxCC_H %>% filter(ItemxCC == i) %>%
select(CC, Total) %>%
group_by (CC) %>%
summarise(Total =sum(Total)) %>%
mutate("prop" = Total/sum(Total))
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
Devengado = Devengado*CCC$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)} else if
(i %in% SIGFE$SIGCOM){
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
Devengado = Devengado*M2$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)}
else  {GG2 <- GG1_nulo
GG1 <- rbind(GG1,GG2) %>% filter(Cuenta!="eliminar")}
}
cuentas <- c("52-ARRENDAMIENTOS",
"60-COMPRA DE CAMAS AL EXTRA SISTEMA CAMAS NO CRÍTICAS",
"61-COMPRA DE CONSULTAS MÉDICAS",
"62-COMPRA DE CONSULTAS NO MÉDICAS",
"63-COMPRA DE INTERVENCIONES QUIRÚRGICAS CLÍNICAS",
"64-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL EXTERNO",
"65-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL INTERNO",
"66-COMPRA DE OTROS SERVICIOS",
"129-MANTENIMIENTO EQUIPO DE CÓMPUTO",
"131-MANTENIMIENTO MAQUINARIA Y EQUIPO",
"132-MANTENIMIENTO MUEBLES Y ENSERES",
"135-MANTENIMIENTO Y REPARACION DE VEHICULOS",
"147-OTROS MANTENIMIENTOS",
"151-PASAJES, FLETES Y BODEGAJE")
for (i in cuentas) {
if(i %in% SIGFE$SIGCOM & i %in% CxCC$ItemxCC){
CCC <- CxCC %>% filter(ItemxCC == i) %>%
select(CC, Total) %>%
group_by (CC) %>%
summarise(Total =sum(Total)) %>%
mutate("prop" = Total/sum(Total))
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
Devengado = Devengado*CCC$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)}
else if (i %in% SIGFE$SIGCOM){
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
Devengado = Devengado*M2$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)}
else  {GG2 <- GG1_nulo
GG1 <- rbind(GG1,GG2) %>% filter(Cuenta!="eliminar")}
}
View(CCC)
CxCC_H <- paste0(ruta_base,resto,mes_archivo,"/Insumos de info anual/CxCC_historico.xlsx")
CxCC_H <- read_excel(CxCC_H, range = "A3:M90000", na = "eliminar")
CxCC_H <- CxCC_H %>%  filter (`ITEM PRESUPUESTARIO` != "eliminar", PRECIO != 0) %>%
mutate(item_pres=`ITEM PRESUPUESTARIO`, Total=`CANTIDAD DESPACHADA`*PRECIO, CC=`CENTRO DE COSTO`) %>%
mutate(ItemxCC = case_when(item_pres ==	"4001000"	~	"24-MATERIALES DE OFICINA, PRODUCTOS DE PAPEL E IMPRESOS",
item_pres ==	"4007002"	~	"29-MATERIALES Y ELEMENTOS DE ASEO",
item_pres ==	"4008000"	~	"31-MENAJE PARA OFICINA, CASINO Y OTROS",
item_pres ==	"4005000"	~	"18-MATERIAL MEDICO QUIRURGICO",
item_pres ==	"4005003"	~	"18-MATERIAL MEDICO QUIRURGICO",
item_pres ==	"2001000"	~	"43-PRODUCTOS TEXTILES, VESTUARIO Y CALZADO",
item_pres ==	"4003002"	~	"41-PRODUCTOS QUÍMICOS",
item_pres ==	"12999006"	~	"57-COLOCACIÓN FAMILIAR DE MENORES Y EXTRAHOSPITALARIA",
item_pres ==	"29004000"	~	"No considerar",
item_pres ==	"4012000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"2002002"	~	"43-PRODUCTOS TEXTILES, VESTUARIO Y CALZADO",
item_pres ==	"2905001001"	~	"No considerar",
item_pres ==	"9005002"	~	"52-ARRENDAMIENTOS",
item_pres ==	"4010000"	~	"28-MATERIALES PARA MANTENIMIENTO Y REPARACIONES DE INMUEBLES",
item_pres ==	"4009000"	~	"27-MATERIALES INFORMATICOS",
item_pres ==	"4004004"	~	"16-MATERIAL DE OSTEOSÍNTESIS Y PRÓTESIS",
item_pres ==	"4004003"	~	"21-MATERIALES DE CURACIÓN",
item_pres ==	"12999002"	~	"177-SERVICIO DE LABORATORIO",
item_pres ==	"29051000"	~	"No considerar	",
item_pres ==	"4999000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"9005000"	~	"52-ARRENDAMIENTOS",
item_pres ==	"12999003"	~	"65-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL INTERNO",
item_pres ==	"4005002"	~	"18-MATERIAL MEDICO QUIRURGICO",
item_pres ==	"4004001"	~	"30-MEDICAMENTOS",
item_pres ==	"29005002"	~	"No considerar",
item_pres ==	"8007000"	~	"151-PASAJES, FLETES Y BODEGAJE",
item_pres ==	"400400101"	~	"30-MEDICAMENTOS",
item_pres ==	"4004002"	~	"15-MATERIAL DE ODONTOLOGÍA",
item_pres ==	"8001000"	~	"170-SERVICIO DE ASEO",
item_pres ==	"1001000"	~	"46-VÍVERES",
item_pres ==	"04013.00"	~	"8-EQUIPOS MENORES",
item_pres ==	"6006000"	~	"138-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO PREVENTIVO",
item_pres ==	"5003000"	~	"100-GAS PROPANO",
item_pres ==	"31.02.005"	~	"No considerar",
item_pres ==	"4010000"	~	"28-MATERIALES PARA MANTENIMIENTO Y REPARACIONES DE INMUEBLES",
item_pres ==	"4012000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"2905001001"	~	"No considerar",
item_pres ==	"9006000"	~	"52-ARRENDAMIENTOS",
item_pres ==	"5002000"	~	"48-SERVICIO DE AGUA",
item_pres ==	"5001000"	~	"92-SERVICIO DE ENERGÍA",
item_pres ==	"31.02.004"	~	"No considerar",
item_pres ==	"12999014"	~	"59-COMPRA DE CAMAS AL EXTRA SISTEMA CAMAS CRÍTICAS",
item_pres ==	"4007002"	~	"29-MATERIALES Y ELEMENTOS DE ASEO	",
item_pres ==	"8001000"	~	"170-SERVICIO DE ASEO",
item_pres ==	"11002001.1"	~	"76-CURSOS DE CAPACITACIÓN",
item_pres ==	"9005002"	~	"52-ARRENDAMIENTOS",
item_pres ==	"6006001"	~	"138-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO PREVENTIVO",
item_pres ==	"14001.00"	~	"28-MATERIALES PARA MANTENIMIENTO Y REPARACIONES DE INMUEBLES",
item_pres ==	"29004000"	~	"No considerar",
item_pres ==	"5004000"	~	"179-SERVICIO DE MENSAJERIA Y/O CORREO",
item_pres ==	"31.02.005"	~	"No considerar",
item_pres ==	"31.02.006"	~	"No considerar",
item_pres ==	"6001000"	~	"133-MANTENIMIENTO PLANTA FÍSICA",
item_pres ==	"6006002"	~	"137-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO CORRECTIVO",
item_pres ==	"29005002"	~	"No considerar",
item_pres ==	"31.02.004"	~	"No considerar",
item_pres ==	"31.02.999"	~	"No considerar",
item_pres ==	"4012000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"6006000"	~	"138-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO PREVENTIVO",
item_pres ==	"2905001001"	~	"No considerar",
item_pres ==	"12999010"	~	"149-PASAJES Y TRASLADOS DE PACIENTES",
item_pres ==	"8002000"	~	"182-SERVICIO DE VIGILANCIA Y SEGURIDAD",
item_pres ==	"6002000"	~	"135-MANTENIMIENTO Y REPARACION DE VEHICULOS",
item_pres ==	"6007000"	~	"147-OTROS MANTENIMIENTOS",
item_pres ==	"29059000"	~	"No considerar",
item_pres ==	"11001000"	~	"76-CURSOS DE CAPACITACIÓN",
item_pres ==	"12999009"	~	"Agrupado",
item_pres ==	"7003000"	~	"Agrupado",
item_pres ==	"12999002"	~	"66-COMPRA DE OTROS SERVICIOS",
item_pres ==	"12.999.002"	~	"66-COMPRA DE OTROS SERVICIOS",
item_pres ==	"11003000"	~	"66-COMPRA DE OTROS SERVICIOS",
item_pres ==	"9999000"	~	"66-COMPRA DE OTROS SERVICIOS",
TRUE ~ "Asignar Item Presupuestario"),
CC=case_when(CC=="DIRECCION HOSP. ROBERTO DEL RI"~"670-ADMINISTRACIÓN",
CC=="RELACIONES PUBLICAS"~"670-ADMINISTRACIÓN",
CC=="OIRS"~"670-ADMINISTRACIÓN",
CC=="SD.GESTION DEL CUIDADO"~"670-ADMINISTRACIÓN",
CC=="ANATOMIA PATOLOGICA"~"544-ANATOMÍA PATOLÓGICA",
CC=="SERVICIO SOCIAL PACIENTES"~"713-TRABAJO SOCIAL",
CC=="ADM PEDIATRIA"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD PEDIATRIA GRAL C (AISLA"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD PEDIATRIA GRAL B"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD PEDIATRIA GRAL A"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD DE CUIDADOS INTENSIVOS"~"170-UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
CC=="U.C.I. CARDIOVASCULAR"~"198-UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS",
CC=="UNIDAD ONCOLOGIA"~"87-HOSPITALIZACIÓN ONCOLOGÍA",
CC=="PABELLON CARDIOLOGIA"~"464-QUIRÓFANOS CARDIOVASCULAR",
CC=="CIRUGIA PLASTICA Y QUEMADOS"~"90-HOSPITALIZACIÓN QUIRÚRGICA",
CC=="TRAUMATOLOGIA GENERAL"~"485-QUIRÓFANOS TRAUMATOLOGÍA Y ORTOPEDIA",
CC=="CAE CONS. BRONCOPULMONAR"~"282-CONSULTA NEUMOLOGÍA",
CC=="CAE LAB. BRONCOPULMONAR"~"244-PROCEDIMIENTO DE NEUMOLOGÍA",
CC=="CAE CARDIOLOGIA"~"276-CONSULTA CARDIOLOGÍA",
CC=="CAE CIRUGIA GENERAL"~"351-CONSULTA CIRUGÍA PEDIÁTRICA",
CC=="CAE DERMATOLOGIA"~"277-CONSULTA DERMATOLOGÍA",
CC=="CAE ENDOCRINOLOGIA"~"281-CONSULTA ENDOCRINOLOGÍA",
CC=="CAE GASTROENTEROLOGIA"~"290-CONSULTA GASTROENTEROLOGÍA",
CC=="CAE ONCOLOGIA"~"306-CONSULTA HEMATOLOGÍA ONCOLÓGICA",
CC=="CAE CONS. NEFROLOGIA"~"285-CONSULTA NEFROLOGÍA",
CC=="CAE CONS. NEUROLOGIA"~"331-CONSULTA NEUROLOGÍA PEDIÁTRICA",
CC=="CAE LAB. EEG NEUROLOGIA"~"269-PROCEDIMIENTOS DE NEUROLOGÍA",
CC=="CAE CONS. OTORRINOLARINGOLOGIA"~"319-CONSULTA OTORRINOLARINGOLOGÍA",
CC=="CENTRAL DE PROCEDIMIENTOS"~"473-QUIRÓFANOS MENOR AMBULATORIA",
CC=="CAE ODONTOLOGIA"~"356-CONSULTA ODONTOLOGÍA",
CC=="CAE SALUD MENTAL AMBULATORIO"~"280-CONSULTA PSIQUIATRÍA",
CC=="SALUD MENTAL HOSPITALIZADOS"~"149-HOSPITALIZACIÓN PSIQUIATRÍA",
CC=="IMAGENOLOGIA"~"542-IMAGENOLOGÍA",
CC=="UNIDAD DE EMERGENCIA"~"216-EMERGENCIAS PEDIÁTRICAS",
CC=="LABORATORIO CLINICO"~"518-LABORATORIO CLÍNICO",
CC=="LABORATORIO HEMATOLOGIA"~"518-LABORATORIO CLÍNICO",
CC=="LABORATORIO MICROBIOLOGIA"~"518-LABORATORIO CLÍNICO",
CC=="LABORATORIO URGENCIA Y QCA"~"518-LABORATORIO CLÍNICO",
CC=="LAB.CITOMETRIA DE FLUJO"~"518-LABORATORIO CLÍNICO",
CC=="BANCO DE SANGRE"~"575-BANCO DE SANGRE",
CC=="PERSONAL"~"670-ADMINISTRACIÓN",
CC=="ABASTECIMIENTO"~"670-ADMINISTRACIÓN",
CC=="FARMACIA"~"593-SERVICIO FARMACEUTICO",
CC=="ESTERILIZACION"~"662-CENTRAL DE ESTERILIZACIÓN",
CC=="ALIMENTACION"~"652-SERVICIO DE ALIMENTACIÓN",
CC=="RECURSOS FISICOS"~"670-ADMINISTRACIÓN",
CC=="INFRAESTRUCTURA"~"670-ADMINISTRACIÓN",
CC=="HIGIENE HOSPITALARIA"~"648-ASEO",
CC=="TRANSPORTE Y COMUNICACIONES"~"664-TRANSPORTE GENERAL",
CC=="JARDIN INFANTIL DR. A. VIGNAU"~"670-ADMINISTRACIÓN",
CC=="SOME"~"670-ADMINISTRACIÓN",
CC=="INFORMATICA"~"670-ADMINISTRACIÓN",
CC=="RESIDENCIA MEDICA 4TO PISO"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="PABELLON HEMODINAMIA"~"240-PROCEDIMIENTO DE CARDIOLOGÍA",
CC=="CAE CENTRO HEMOFILICO"~"260-PROCEDIMIENTO ONCOLOGÍA",
CC=="CAPACITACION"~"670-ADMINISTRACIÓN",
CC=="EQUIPOS MEDICOS"~"665-MANTENIMIENTO",
CC=="UNIDAD TRATAMIENTO INTERMEDIO"~"170-UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
CC=="CAE VIH"~"284-CONSULTA INFECTOLOGÍA",
CC=="UNIDAD PEDIATRIA GENERAL D"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="COMERCIALIZACION"~"670-ADMINISTRACIÓN",
CC=="GESTION INGRESO Y PERMANENCIA"~"670-ADMINISTRACIÓN",
CC=="UNIDAD COORDINACION GES"~"670-ADMINISTRACIÓN",
CC=="UNIDAD DE GESTION DE DEMANDA"~"670-ADMINISTRACIÓN",
CC=="UNIDAD DE REHABILITACION"~"567-REHABILITACIÓN",
CC=="EQUIPOS INDUSTRIALES"~"670-ADMINISTRACIÓN",
CC=="SERVICIOS GENERALES"~"664-TRANSPORTE GENERAL",
CC=="UTI CARDIOVASCULAR"~"198-UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS",
CC=="AUDITORIA"~"670-ADMINISTRACIÓN",
CC=="UNIDAD CONTROL DEL GESTION"~"670-ADMINISTRACIÓN",
CC=="ADM QUIRURGICO"~"90-HOSPITALIZACIÓN QUIRÚRGICA",
CC=="CAE UROLOGIA"~"311-CONSULTA UROLOGÍA",
CC=="CAE CONS. OFTALMOLOGIA"~"317-CONSULTA OFTALMOLOGÍA",
CC=="SERVICIO SOCIAL PERSONAL"~"713-TRABAJO SOCIAL",
CC=="CONTABILIDAD Y PRESUPUESTO"~"670-ADMINISTRACIÓN",
CC=="SEGURIDAD"~"670-ADMINISTRACIÓN",
CC=="ASEO Y ORNATO PATIOS Y JARDINE"~"648-ASEO",
CC=="BIBLIOTECA"~"670-ADMINISTRACIÓN",
CC=="RESIDENCIA ENFERMERAS"~"670-ADMINISTRACIÓN",
CC=="ESTADISTICA"~"670-ADMINISTRACIÓN",
CC=="S.D.RR.HH"~"670-ADMINISTRACIÓN",
CC=="CHILE CRECE CONTIGO"~"713-TRABAJO SOCIAL",
CC=="UNIDAD ANALISIS REG.CLINICO"~"670-ADMINISTRACIÓN",
CC=="INFRAESTRUCTURA HOSPITAL"~"670-ADMINISTRACIÓN",
CC=="PREV.RIESGO Y S.OCUPACIONAL"~"670-ADMINISTRACIÓN",
CC=="SALA REAS"~"670-ADMINISTRACIÓN",
CC=="EQUIPOS INDUSTRIALES(HOSPITAL)"~"670-ADMINISTRACIÓN",
CC=="I.A.A.S"~"670-ADMINISTRACIÓN",
CC=="UNIDAD ASISTENCIAL DOCENTE"~"670-ADMINISTRACIÓN",
CC=="LAB.BIOLOGIA MOLECULAR"~"518-LABORATORIO CLÍNICO",
CC=="CAE PREMATUROS"~"328-CONSULTA PEDIATRÍA GENERAL",
CC=="SALA CUIDADO PROLONGADO"~"170-UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
CC=="VACUNATORIO"~"670-ADMINISTRACIÓN",
CC=="OFICINA DE SUELDOS"~"670-ADMINISTRACIÓN",
CC=="SUBDIRECCION ADMINISTRATIVA"~"670-ADMINISTRACIÓN",
CC=="SUBDIRECCION MEDICA"~"670-ADMINISTRACIÓN",
CC=="EQUIPAMIENTO HOSPITAL"~"670-ADMINISTRACIÓN",
CC=="BODEGAS ABASTECIMIENTO"~"670-ADMINISTRACIÓN",
CC=="CIRUGIA GENERAL"~"90-HOSPITALIZACIÓN QUIRÚRGICA",
CC=="C.COSTO GLOBAL"~"670-ADMINISTRACIÓN",
CC=="GASTOS HOSPITAL"~"670-ADMINISTRACIÓN",
CC=="CAE ESPECIALIDADES 2"~"Cae Prorratear",
CC=="PABELLONES"~"Pabellón Prorratear",
TRUE ~ "Asignar CC"
)) %>%
select(item_pres, CC,ItemxCC, Total) %>%
group_by (item_pres, CC,ItemxCC,) %>%
summarise("Total" = sum(Total)) %>%
ungroup()
CxCC_H <- read_excel(CxCC_H, range = "A3:M90000", na = "eliminar")
CxCC_H <- paste0(ruta_base,resto,"/Insumos de info anual/CxCC_historico.xlsx")
CxCC_H <- read_excel(CxCC_H, range = "A3:M90000", na = "eliminar")
CxCC_H <- CxCC_H %>%  filter (`ITEM PRESUPUESTARIO` != "eliminar", PRECIO != 0) %>%
mutate(item_pres=`ITEM PRESUPUESTARIO`, Total=`CANTIDAD DESPACHADA`*PRECIO, CC=`CENTRO DE COSTO`) %>%
mutate(ItemxCC = case_when(item_pres ==	"4001000"	~	"24-MATERIALES DE OFICINA, PRODUCTOS DE PAPEL E IMPRESOS",
item_pres ==	"4007002"	~	"29-MATERIALES Y ELEMENTOS DE ASEO",
item_pres ==	"4008000"	~	"31-MENAJE PARA OFICINA, CASINO Y OTROS",
item_pres ==	"4005000"	~	"18-MATERIAL MEDICO QUIRURGICO",
item_pres ==	"4005003"	~	"18-MATERIAL MEDICO QUIRURGICO",
item_pres ==	"2001000"	~	"43-PRODUCTOS TEXTILES, VESTUARIO Y CALZADO",
item_pres ==	"4003002"	~	"41-PRODUCTOS QUÍMICOS",
item_pres ==	"12999006"	~	"57-COLOCACIÓN FAMILIAR DE MENORES Y EXTRAHOSPITALARIA",
item_pres ==	"29004000"	~	"No considerar",
item_pres ==	"4012000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"2002002"	~	"43-PRODUCTOS TEXTILES, VESTUARIO Y CALZADO",
item_pres ==	"2905001001"	~	"No considerar",
item_pres ==	"9005002"	~	"52-ARRENDAMIENTOS",
item_pres ==	"4010000"	~	"28-MATERIALES PARA MANTENIMIENTO Y REPARACIONES DE INMUEBLES",
item_pres ==	"4009000"	~	"27-MATERIALES INFORMATICOS",
item_pres ==	"4004004"	~	"16-MATERIAL DE OSTEOSÍNTESIS Y PRÓTESIS",
item_pres ==	"4004003"	~	"21-MATERIALES DE CURACIÓN",
item_pres ==	"12999002"	~	"177-SERVICIO DE LABORATORIO",
item_pres ==	"29051000"	~	"No considerar	",
item_pres ==	"4999000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"9005000"	~	"52-ARRENDAMIENTOS",
item_pres ==	"12999003"	~	"65-COMPRA DE INTERVENCIONES QUIRÚRGICAS INTRAHOSPITALARIAS CON PERSONAL INTERNO",
item_pres ==	"4005002"	~	"18-MATERIAL MEDICO QUIRURGICO",
item_pres ==	"4004001"	~	"30-MEDICAMENTOS",
item_pres ==	"29005002"	~	"No considerar",
item_pres ==	"8007000"	~	"151-PASAJES, FLETES Y BODEGAJE",
item_pres ==	"400400101"	~	"30-MEDICAMENTOS",
item_pres ==	"4004002"	~	"15-MATERIAL DE ODONTOLOGÍA",
item_pres ==	"8001000"	~	"170-SERVICIO DE ASEO",
item_pres ==	"1001000"	~	"46-VÍVERES",
item_pres ==	"04013.00"	~	"8-EQUIPOS MENORES",
item_pres ==	"6006000"	~	"138-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO PREVENTIVO",
item_pres ==	"5003000"	~	"100-GAS PROPANO",
item_pres ==	"31.02.005"	~	"No considerar",
item_pres ==	"4010000"	~	"28-MATERIALES PARA MANTENIMIENTO Y REPARACIONES DE INMUEBLES",
item_pres ==	"4012000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"2905001001"	~	"No considerar",
item_pres ==	"9006000"	~	"52-ARRENDAMIENTOS",
item_pres ==	"5002000"	~	"48-SERVICIO DE AGUA",
item_pres ==	"5001000"	~	"92-SERVICIO DE ENERGÍA",
item_pres ==	"31.02.004"	~	"No considerar",
item_pres ==	"12999014"	~	"59-COMPRA DE CAMAS AL EXTRA SISTEMA CAMAS CRÍTICAS",
item_pres ==	"4007002"	~	"29-MATERIALES Y ELEMENTOS DE ASEO	",
item_pres ==	"8001000"	~	"170-SERVICIO DE ASEO",
item_pres ==	"11002001.1"	~	"76-CURSOS DE CAPACITACIÓN",
item_pres ==	"9005002"	~	"52-ARRENDAMIENTOS",
item_pres ==	"6006001"	~	"138-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO PREVENTIVO",
item_pres ==	"14001.00"	~	"28-MATERIALES PARA MANTENIMIENTO Y REPARACIONES DE INMUEBLES",
item_pres ==	"29004000"	~	"No considerar",
item_pres ==	"5004000"	~	"179-SERVICIO DE MENSAJERIA Y/O CORREO",
item_pres ==	"31.02.005"	~	"No considerar",
item_pres ==	"31.02.006"	~	"No considerar",
item_pres ==	"6001000"	~	"133-MANTENIMIENTO PLANTA FÍSICA",
item_pres ==	"6006002"	~	"137-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO CORRECTIVO",
item_pres ==	"29005002"	~	"No considerar",
item_pres ==	"31.02.004"	~	"No considerar",
item_pres ==	"31.02.999"	~	"No considerar",
item_pres ==	"4012000"	~	"35-OTROS INSUMOS Y MATERIALES",
item_pres ==	"6006000"	~	"138-MANTENIMIENTO Y REPARACIÓN MÁQUINA Y EQUIPO PREVENTIVO",
item_pres ==	"2905001001"	~	"No considerar",
item_pres ==	"12999010"	~	"149-PASAJES Y TRASLADOS DE PACIENTES",
item_pres ==	"8002000"	~	"182-SERVICIO DE VIGILANCIA Y SEGURIDAD",
item_pres ==	"6002000"	~	"135-MANTENIMIENTO Y REPARACION DE VEHICULOS",
item_pres ==	"6007000"	~	"147-OTROS MANTENIMIENTOS",
item_pres ==	"29059000"	~	"No considerar",
item_pres ==	"11001000"	~	"76-CURSOS DE CAPACITACIÓN",
item_pres ==	"12999009"	~	"Agrupado",
item_pres ==	"7003000"	~	"Agrupado",
item_pres ==	"12999002"	~	"66-COMPRA DE OTROS SERVICIOS",
item_pres ==	"12.999.002"	~	"66-COMPRA DE OTROS SERVICIOS",
item_pres ==	"11003000"	~	"66-COMPRA DE OTROS SERVICIOS",
item_pres ==	"9999000"	~	"66-COMPRA DE OTROS SERVICIOS",
TRUE ~ "Asignar Item Presupuestario"),
CC=case_when(CC=="DIRECCION HOSP. ROBERTO DEL RI"~"670-ADMINISTRACIÓN",
CC=="RELACIONES PUBLICAS"~"670-ADMINISTRACIÓN",
CC=="OIRS"~"670-ADMINISTRACIÓN",
CC=="SD.GESTION DEL CUIDADO"~"670-ADMINISTRACIÓN",
CC=="ANATOMIA PATOLOGICA"~"544-ANATOMÍA PATOLÓGICA",
CC=="SERVICIO SOCIAL PACIENTES"~"713-TRABAJO SOCIAL",
CC=="ADM PEDIATRIA"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD PEDIATRIA GRAL C (AISLA"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD PEDIATRIA GRAL B"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD PEDIATRIA GRAL A"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="UNIDAD DE CUIDADOS INTENSIVOS"~"170-UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
CC=="U.C.I. CARDIOVASCULAR"~"198-UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS",
CC=="UNIDAD ONCOLOGIA"~"87-HOSPITALIZACIÓN ONCOLOGÍA",
CC=="PABELLON CARDIOLOGIA"~"464-QUIRÓFANOS CARDIOVASCULAR",
CC=="CIRUGIA PLASTICA Y QUEMADOS"~"90-HOSPITALIZACIÓN QUIRÚRGICA",
CC=="TRAUMATOLOGIA GENERAL"~"485-QUIRÓFANOS TRAUMATOLOGÍA Y ORTOPEDIA",
CC=="CAE CONS. BRONCOPULMONAR"~"282-CONSULTA NEUMOLOGÍA",
CC=="CAE LAB. BRONCOPULMONAR"~"244-PROCEDIMIENTO DE NEUMOLOGÍA",
CC=="CAE CARDIOLOGIA"~"276-CONSULTA CARDIOLOGÍA",
CC=="CAE CIRUGIA GENERAL"~"351-CONSULTA CIRUGÍA PEDIÁTRICA",
CC=="CAE DERMATOLOGIA"~"277-CONSULTA DERMATOLOGÍA",
CC=="CAE ENDOCRINOLOGIA"~"281-CONSULTA ENDOCRINOLOGÍA",
CC=="CAE GASTROENTEROLOGIA"~"290-CONSULTA GASTROENTEROLOGÍA",
CC=="CAE ONCOLOGIA"~"306-CONSULTA HEMATOLOGÍA ONCOLÓGICA",
CC=="CAE CONS. NEFROLOGIA"~"285-CONSULTA NEFROLOGÍA",
CC=="CAE CONS. NEUROLOGIA"~"331-CONSULTA NEUROLOGÍA PEDIÁTRICA",
CC=="CAE LAB. EEG NEUROLOGIA"~"269-PROCEDIMIENTOS DE NEUROLOGÍA",
CC=="CAE CONS. OTORRINOLARINGOLOGIA"~"319-CONSULTA OTORRINOLARINGOLOGÍA",
CC=="CENTRAL DE PROCEDIMIENTOS"~"473-QUIRÓFANOS MENOR AMBULATORIA",
CC=="CAE ODONTOLOGIA"~"356-CONSULTA ODONTOLOGÍA",
CC=="CAE SALUD MENTAL AMBULATORIO"~"280-CONSULTA PSIQUIATRÍA",
CC=="SALUD MENTAL HOSPITALIZADOS"~"149-HOSPITALIZACIÓN PSIQUIATRÍA",
CC=="IMAGENOLOGIA"~"542-IMAGENOLOGÍA",
CC=="UNIDAD DE EMERGENCIA"~"216-EMERGENCIAS PEDIÁTRICAS",
CC=="LABORATORIO CLINICO"~"518-LABORATORIO CLÍNICO",
CC=="LABORATORIO HEMATOLOGIA"~"518-LABORATORIO CLÍNICO",
CC=="LABORATORIO MICROBIOLOGIA"~"518-LABORATORIO CLÍNICO",
CC=="LABORATORIO URGENCIA Y QCA"~"518-LABORATORIO CLÍNICO",
CC=="LAB.CITOMETRIA DE FLUJO"~"518-LABORATORIO CLÍNICO",
CC=="BANCO DE SANGRE"~"575-BANCO DE SANGRE",
CC=="PERSONAL"~"670-ADMINISTRACIÓN",
CC=="ABASTECIMIENTO"~"670-ADMINISTRACIÓN",
CC=="FARMACIA"~"593-SERVICIO FARMACEUTICO",
CC=="ESTERILIZACION"~"662-CENTRAL DE ESTERILIZACIÓN",
CC=="ALIMENTACION"~"652-SERVICIO DE ALIMENTACIÓN",
CC=="RECURSOS FISICOS"~"670-ADMINISTRACIÓN",
CC=="INFRAESTRUCTURA"~"670-ADMINISTRACIÓN",
CC=="HIGIENE HOSPITALARIA"~"648-ASEO",
CC=="TRANSPORTE Y COMUNICACIONES"~"664-TRANSPORTE GENERAL",
CC=="JARDIN INFANTIL DR. A. VIGNAU"~"670-ADMINISTRACIÓN",
CC=="SOME"~"670-ADMINISTRACIÓN",
CC=="INFORMATICA"~"670-ADMINISTRACIÓN",
CC=="RESIDENCIA MEDICA 4TO PISO"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="PABELLON HEMODINAMIA"~"240-PROCEDIMIENTO DE CARDIOLOGÍA",
CC=="CAE CENTRO HEMOFILICO"~"260-PROCEDIMIENTO ONCOLOGÍA",
CC=="CAPACITACION"~"670-ADMINISTRACIÓN",
CC=="EQUIPOS MEDICOS"~"665-MANTENIMIENTO",
CC=="UNIDAD TRATAMIENTO INTERMEDIO"~"170-UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
CC=="CAE VIH"~"284-CONSULTA INFECTOLOGÍA",
CC=="UNIDAD PEDIATRIA GENERAL D"~"116-HOSPITALIZACIÓN PEDIATRÍA",
CC=="COMERCIALIZACION"~"670-ADMINISTRACIÓN",
CC=="GESTION INGRESO Y PERMANENCIA"~"670-ADMINISTRACIÓN",
CC=="UNIDAD COORDINACION GES"~"670-ADMINISTRACIÓN",
CC=="UNIDAD DE GESTION DE DEMANDA"~"670-ADMINISTRACIÓN",
CC=="UNIDAD DE REHABILITACION"~"567-REHABILITACIÓN",
CC=="EQUIPOS INDUSTRIALES"~"670-ADMINISTRACIÓN",
CC=="SERVICIOS GENERALES"~"664-TRANSPORTE GENERAL",
CC=="UTI CARDIOVASCULAR"~"198-UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS",
CC=="AUDITORIA"~"670-ADMINISTRACIÓN",
CC=="UNIDAD CONTROL DEL GESTION"~"670-ADMINISTRACIÓN",
CC=="ADM QUIRURGICO"~"90-HOSPITALIZACIÓN QUIRÚRGICA",
CC=="CAE UROLOGIA"~"311-CONSULTA UROLOGÍA",
CC=="CAE CONS. OFTALMOLOGIA"~"317-CONSULTA OFTALMOLOGÍA",
CC=="SERVICIO SOCIAL PERSONAL"~"713-TRABAJO SOCIAL",
CC=="CONTABILIDAD Y PRESUPUESTO"~"670-ADMINISTRACIÓN",
CC=="SEGURIDAD"~"670-ADMINISTRACIÓN",
CC=="ASEO Y ORNATO PATIOS Y JARDINE"~"648-ASEO",
CC=="BIBLIOTECA"~"670-ADMINISTRACIÓN",
CC=="RESIDENCIA ENFERMERAS"~"670-ADMINISTRACIÓN",
CC=="ESTADISTICA"~"670-ADMINISTRACIÓN",
CC=="S.D.RR.HH"~"670-ADMINISTRACIÓN",
CC=="CHILE CRECE CONTIGO"~"713-TRABAJO SOCIAL",
CC=="UNIDAD ANALISIS REG.CLINICO"~"670-ADMINISTRACIÓN",
CC=="INFRAESTRUCTURA HOSPITAL"~"670-ADMINISTRACIÓN",
CC=="PREV.RIESGO Y S.OCUPACIONAL"~"670-ADMINISTRACIÓN",
CC=="SALA REAS"~"670-ADMINISTRACIÓN",
CC=="EQUIPOS INDUSTRIALES(HOSPITAL)"~"670-ADMINISTRACIÓN",
CC=="I.A.A.S"~"670-ADMINISTRACIÓN",
CC=="UNIDAD ASISTENCIAL DOCENTE"~"670-ADMINISTRACIÓN",
CC=="LAB.BIOLOGIA MOLECULAR"~"518-LABORATORIO CLÍNICO",
CC=="CAE PREMATUROS"~"328-CONSULTA PEDIATRÍA GENERAL",
CC=="SALA CUIDADO PROLONGADO"~"170-UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
CC=="VACUNATORIO"~"670-ADMINISTRACIÓN",
CC=="OFICINA DE SUELDOS"~"670-ADMINISTRACIÓN",
CC=="SUBDIRECCION ADMINISTRATIVA"~"670-ADMINISTRACIÓN",
CC=="SUBDIRECCION MEDICA"~"670-ADMINISTRACIÓN",
CC=="EQUIPAMIENTO HOSPITAL"~"670-ADMINISTRACIÓN",
CC=="BODEGAS ABASTECIMIENTO"~"670-ADMINISTRACIÓN",
CC=="CIRUGIA GENERAL"~"90-HOSPITALIZACIÓN QUIRÚRGICA",
CC=="C.COSTO GLOBAL"~"670-ADMINISTRACIÓN",
CC=="GASTOS HOSPITAL"~"670-ADMINISTRACIÓN",
CC=="CAE ESPECIALIDADES 2"~"Cae Prorratear",
CC=="PABELLONES"~"Pabellón Prorratear",
TRUE ~ "Asignar CC"
)) %>%
select(item_pres, CC,ItemxCC, Total) %>%
group_by (item_pres, CC,ItemxCC,) %>%
summarise("Total" = sum(Total)) %>%
ungroup()
for (i in cuentas) {
if(i %in% SIGFE$SIGCOM & i %in% CxCC$ItemxCC){
CCC <- CxCC %>% filter(ItemxCC == i) %>%
select(CC, Total) %>%
group_by (CC) %>%
summarise(Total =sum(Total)) %>%
mutate("prop" = Total/sum(Total))
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
Devengado = Devengado*CCC$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)}
else if (i %in% SIGFE$SIGCOM & i %in% CxCC_H$ItemxCC){
CCC <- CxCC_H %>% filter(ItemxCC == i) %>%
select(CC, Total) %>%
group_by (CC) %>%
summarise(Total =sum(Total)) %>%
mutate("prop" = Total/sum(Total))
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = CCC$CC,
Devengado = Devengado*CCC$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)}
else if (i %in% SIGFE$SIGCOM){
GG2 <-  SIGFE %>% group_by(SIGCOM) %>%
summarise(Devengado = sum(Devengado)) %>%
filter(SIGCOM == i)
GG2 <- GG2 %>% summarise("Centro de Costo" = M2$CC,
Devengado = Devengado*M2$prop,
"Cuenta"=i, "Tipo" = 2)
GG1 <- rbind(GG1,GG2)}
else  {GG2 <- GG1_nulo
GG1 <- rbind(GG1,GG2) %>% filter(Cuenta!="eliminar")}
}
