Unidad == "198__05305 - UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS" ~  "198__05305 - UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS",
Unidad == "196__05303 - UNIDAD DE TRATAMIENTO INTENSIVO PEDÍATRICA" ~  "196__05303 - UNIDAD DE TRATAMIENTO INTENSIVO PEDÍATRICA",
Unidad == "177__05012 - UNIDAD DE CUIDADOS CORONARIOS" ~  "177__05012 - UNIDAD DE CUIDADOS CORONARIOS",
TRUE ~ "No")) %>%
mutate("Unidades de Producción" = case_when(
`Información Estadística` == "Egresos- Alta" ~ "1__Transferencia",
`Información Estadística` == "Egresos-Fallecidos" ~ "1__Transferencia",
`Información Estadística` == "Egresos-Traslados" ~ "1__Transferencia",
`Información Estadística` == "Ocupada" ~ "2__DCO",
`Información Estadística` == "N° camas dotación" ~ "6__N. Camas",
TRUE ~ "No")) %>%
filter(`Unidades de Producción` != "No" & `Centro de Producción` != "No") %>%
group_by(Fecha, `Centro de Producción`, `Unidades de Producción`) %>%
summarise("Valor" = sum(Total))
Egreso <- Censo_hrrio_BBDD %>% filter(Fecha == Fecha_filtro) %>%
mutate("Centro de Producción" = case_when(
Unidad == "170__05005 - UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA" ~  "170__05005 - UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
Unidad == "198__05305 - UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS" ~  "198__05305 - UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS",
Unidad == "196__05303 - UNIDAD DE TRATAMIENTO INTENSIVO PEDÍATRICA" ~  "196__05303 - UNIDAD DE TRATAMIENTO INTENSIVO PEDÍATRICA",
Unidad == "177__05012 - UNIDAD DE CUIDADOS CORONARIOS" ~  "177__05012 - UNIDAD DE CUIDADOS CORONARIOS",
TRUE ~ "No")) %>%
mutate("Unidades de Producción" = case_when(
`Información Estadística` == "Egresos- Alta" ~ "3__Egreso",
`Información Estadística` == "Egresos-Fallecidos" ~ "3__Egreso",
TRUE ~ "No")) %>%
filter(`Unidades de Producción` != "No" & `Centro de Producción` != "No") %>%
group_by(Fecha, `Centro de Producción`, `Unidades de Producción`) %>%
summarise("Valor" = sum(Total))
Censo_Critico <- rbind(Censo_Critico, Egreso)
# TELEMEDICINA ------------------------------------------------------------
telemedicina <- read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/Ambulatorio/A30 BBDD.xlsx")
telemedicina$Fecha=as.character(telemedicina$Fecha)
telemedicina <- telemedicina %>%
filter(Fecha == Fecha_filtro) %>%
group_by(Fecha) %>%
summarise("Valor" = sum(Telemedicina_Nueva)+ sum(Telemedicina_Control) +sum(Telemedicina_Hospitalizados)) %>%
add_column("Centro de Producción" = "359__15701 - TELEMEDICINA", .after = 1) %>%
add_column("Unidades de Producción" = "1__Atención", .after = 2)
Produccion_SIGCOM <- rbind(Produccion_SIGCOM,telemedicina, A08_PERC, Censo_Critico, Censo_No_Critico)
rm(A07_PERC, A09I_PERC, A08_PERC, Censo_Critico, Censo_No_Critico, Censo_hrrio_BBDD, telemedicina)
# REM B -------------------------------------------------------------------
B_qx1 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O1380:X1380")
B_qx1 <- B_qx1 %>%   add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "475__33016 - QUIRÓFANOS NEUROCIRUGÍA", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx1$...1 + B_qx1$...10, .after = 13)
B_qx2 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O1514:X1514")
B_qx2 <- B_qx2 %>%   add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx2$...1 + B_qx2$...10, .after = 13)
B_qx3 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O1696:X1696")
B_qx3 <- B_qx3 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx3$...1 + B_qx3$...10, .after = 13)
B_qx4 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O1760:X1760")
B_qx4 <- B_qx4 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx4$...1 + B_qx4$...10, .after = 13)
B_qx5 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O1834:X1834")
B_qx5 <- B_qx5 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "493__33034 - QUIRÓFANOS CIRUGÍA PLÁSTICA", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx5$...1 + B_qx5$...10, .after = 13)
B_qx6 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O1877:X1877")
B_qx6 <- B_qx6 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx6$...1 + B_qx6$...10, .after = 13)
B_qx7 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2104:X2104")
B_qx7 <- B_qx7 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "464__33005 - QUIRÓFANOS CARDIOVASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx7$...1 + B_qx7$...10, .after = 13)
B_qx8 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2190:X2190")
B_qx8 <- B_qx8 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx8$...1 + B_qx8$...10, .after = 13)
B_qx9 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2379:X2379")
B_qx9 <- B_qx9 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "467__33008 - QUIRÓFANOS DIGESTIVA", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx9$...1 + B_qx9$...10, .after = 13)
B_qx10 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2419:X2419")
B_qx10 <- B_qx10 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx10$...1 + B_qx10$...10, .after = 13)
B_qx11 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2541:X2541")
B_qx11 <- B_qx11 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "486__33027 - QUIRÓFANOS UROLOGÍA", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx11$...1 + B_qx11$...10, .after = 13)
B_qx12 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2575:X2575")
B_qx12 <- B_qx12 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx12$...1 + B_qx12$...10, .after = 13)
B_qx13 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2615:X2615")
B_qx13 <- B_qx13 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx13$...1 + B_qx13$...10, .after = 13)
B_qx14 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2631:X2631")
B_qx14 <- B_qx14 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "495__33036 - QUIRÓFANOS CIRUGÍA VASCULAR", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx14$...1 + B_qx14$...10, .after = 13)
B_qx15 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2865:X2865")
B_qx15 <- B_qx15 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "485__33026 - QUIRÓFANOS TRAUMATOLOGÍA Y ORTOPEDIA", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx15$...1 + B_qx15$...10, .after = 13)
B_qx16 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2870:X2870")
B_qx16 <- B_qx16 %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "485__33026 - QUIRÓFANOS TRAUMATOLOGÍA Y ORTOPEDIA", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx16$...1 + B_qx16$...10, .after = 13)
B_qxCMA <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
range = "B!O2870:X2870")  #lee cualquier rango solo para darle la forma
B_qxCMA <- B_qxCMA %>%  add_column("Fecha" = Fecha_filtro, .after = 10) %>%
add_column("Centro de Producción" = "471__33012 - QUIRÓFANOS MAYOR AMBULATORIA", .after = 11) %>%
add_column("Unidades de Producción" = "1__Intervencion quirurgica", .after = 12) %>%
add_column("Valor" = B_qx1$...4 + B_qx2$...4 + B_qx3$...4 + B_qx4$...4 + B_qx5$...4 + B_qx6$...4 +
B_qx7$...4 + B_qx8$...4 + B_qx9$...4 + B_qx10$...4 + B_qx11$...4 + B_qx12$...4 +
B_qx13$...4 + B_qx14$...4 + B_qx15$...4 + B_qx16$...4, .after = 13)
B_qx <- rbind(B_qx1,B_qx2,B_qx3,B_qx4,B_qx5,B_qx6,B_qx7,B_qx8,B_qx9, B_qx10,
B_qx11,B_qx12,B_qx13,B_qx14,B_qx15,B_qx16,B_qxCMA)
rm(B_qx1,B_qx2,B_qx3,B_qx4,B_qx5,B_qx6,B_qx7,B_qx8,B_qx9, B_qx10,
B_qx11,B_qx12,B_qx13,B_qx14,B_qx15,B_qx16, B_qxCMA)
B_qx <- B_qx %>% group_by(Fecha, `Centro de Producción`, `Unidades de Producción`) %>%
summarise("Valor" = sum(Valor))
Produccion_SIGCOM <- rbind( Produccion_SIGCOM, B_qx)
# Procedimientos -----------------------------------------------------------
# P1 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                      range = "B!C1145:C1145")
# P1 <- P1 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15305__15305 - CONSULTA NEUROLOGÍA PEDIÁTRICA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P1$...1,  .after = 4)
#
# P2 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C1271:C1271")
# P2 <- P2 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15209__15209 - CONSULTA OFTALMOLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P2$...1,  .after = 4)
#
# P3 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C1424:C1424")
# P3 <- P3 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15211__15211 - CONSULTA OTORRINOLARINGOLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P3$...1,  .after = 4)
#
# P4 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C1653:C1653")
# P4 <- P4 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15106__15106 - CONSULTA DERMATOLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P4$...1,  .after = 4)
#
# P5 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C2246:C2246")
# P5 <- P5 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15203__15203 - CONSULTA UROLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P5$...1,  .after = 4)
#
# P6 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C1812:C1812")
# P6 <- P6 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15105__15105 - CONSULTA CARDIOLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P6$...1,  .after = 4)
#
# P7 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C1682:C1701")
# P7 <- P7 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15105__15105 - CONSULTA CARDIOLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P7$...1,  .after = 4)
#
# P8 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C1712:C1785")
# P8 <- P8 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15111__15111 - CONSULTA NEUMOLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P8$...1,  .after = 4)
#
# P9 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C2056:C2056")
# P9 <- P9 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15119__15119 - CONSULTA GASTROENTEROLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P9$...1,  .after = 4)
#
# P10 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                 range = "B!C2062:C2062")
# P10 <- P10 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15119__15119 - CONSULTA GASTROENTEROLOGÍA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P10$...1,  .after = 4)
#
# P11 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                  range = "B!C2453:C2453")
# P11 <- P11 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15316__15316 - CONSULTA TRAUMATOLOGÍA PEDIÁTRICA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P11$...1,  .after = 4)
#
# P12 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                  range = "B!C2684:C2684")
# P12 <- P12 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15316__15316 - CONSULTA TRAUMATOLOGÍA PEDIÁTRICA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P12$...1,  .after = 4)
#
# P13 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                  range = "B!C2363:C2363")
# P13 <- P13 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15502__15502 - CONSULTA GINECOLOGICA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P13$...1,  .after = 4)
#
# P14 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                  range = "B!C2416:C2416")
# P14 <- P14 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15502__15502 - CONSULTA GINECOLOGICA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P14$...1,  .after = 4)
#
# P15 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                  range = "B17!C102:C102")
# P15 <- P15 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15135__15135 - CONSULTA HEMATOLOGÍA ONCOLÓGICA", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P15$...1,  .after = 4)
#
# P16 <- read_xlsx(archivoBS, na = " ",col_names = FALSE,
#                  range = "B!C1011:C1011")
# P16 <- P16 %>%  add_column("Fecha" = Fecha_filtro, .after = 1) %>%
#   add_column("Centro de Producción" = "15302__15302 - CONSULTA PEDIATRÍA GENERAL", .after = 2) %>%
#   add_column("Unidades de Producción" = "2__Procedimiento", .after = 3) %>%
#   add_column("Valor" = P16$...1,  .after = 4)
#
# P <- rbind(P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12, P13, P14, P15, P16)
#
# P <- P %>% group_by(Fecha, `Centro de Producción`, `Unidades de Producción`) %>%
#   summarise("Valor" = sum(Valor))
#
# Produccion_SIGCOM <- rbind( Produccion_SIGCOM, P, B_qx)
# Remotas -----------------------------------------------------------------
At_remota <- read_excel(remota, sheet = "Teleconsulta")
At_remota <- At_remota %>% filter(ESTADO=="Asistente" & MES_ATENCION==mes) %>%
# At_remota <- At_remota %>% filter(ESTADO=="Asistente" & TIPO_INGRESO!="Control Abreviado") %>%
group_by(UNIDAD_ATENCION_DESC) %>%
count(UNIDAD_ATENCION_DESC) %>%  mutate(Fecha=Fecha_filtro,"Centro de Producción" = case_when(
UNIDAD_ATENCION_DESC == "Pediatria" ~ "15302__15302 - CONSULTA PEDIATRÍA GENERAL",
UNIDAD_ATENCION_DESC == "Broncopulmonar Infantil" ~ "15111__15111 - CONSULTA NEUMOLOGÍA",
UNIDAD_ATENCION_DESC == "Anestesiologia Infantil" ~ "15125__15125 - CONSULTA ANESTESIOLOGIA",
UNIDAD_ATENCION_DESC == "Cardiologia Infantil" ~ "15105__15105 - CONSULTA CARDIOLOGÍA",
UNIDAD_ATENCION_DESC == "Cirugia Plastica" ~ "15208__15208 - CONSULTA CIRUGÍA PLÁSTICA",
UNIDAD_ATENCION_DESC == "Cirugia Infantil" ~ "15409__15409 - CONSULTA CIRUGÍA PEDIÁTRICA",
UNIDAD_ATENCION_DESC == "Endocrinologia Infantil" ~ "15110__15110 - CONSULTA ENDOCRINOLOGÍA",
UNIDAD_ATENCION_DESC == "Endocrinologia Infantil " ~ "15110__15110 - CONSULTA ENDOCRINOLOGÍA",
UNIDAD_ATENCION_DESC == "Dermatologia Infantil" ~ "15106__15106 - CONSULTA DERMATOLOGÍA",
UNIDAD_ATENCION_DESC == "Gastroenterologia Infantil" ~ "15119__15119 - CONSULTA GASTROENTEROLOGÍA",
UNIDAD_ATENCION_DESC == "Ginecologia Infantil" ~ "15302__15302 - CONSULTA PEDIATRÍA GENERAL",
UNIDAD_ATENCION_DESC == "Ginecologia pediatrica y de la adolescencia" ~ "15302__15302 - CONSULTA PEDIATRÍA GENERAL",
UNIDAD_ATENCION_DESC == "Genetica Infantil" ~ "15115__15115 - CONSULTA GENÉTICA",
UNIDAD_ATENCION_DESC == "Hemato-Oncologia" ~ "15135__15135 - CONSULTA HEMATOLOGÍA ONCOLÓGICA",
UNIDAD_ATENCION_DESC == "Hemofilia Adulto" ~ "15135__15135 - CONSULTA HEMATOLOGÍA ONCOLÓGICA",
UNIDAD_ATENCION_DESC == "Infectologia Infantil" ~ "15113__15113 - CONSULTA INFECTOLOGÍA",
UNIDAD_ATENCION_DESC == "Nefrologia Infantil" ~ "15114__15114 - CONSULTA NEFROLOGÍA",
UNIDAD_ATENCION_DESC == "Neurologia Infantil" ~ "15305__15305 - CONSULTA NEUROLOGÍA PEDIÁTRICA",
UNIDAD_ATENCION_DESC == "Nutriologia Infantil" ~ "15008__15008 - CONSULTA NUTRICIÓN",
UNIDAD_ATENCION_DESC == "Otorrinolaringologia" ~ "15211__15211 - CONSULTA OTORRINOLARINGOLOGÍA",
UNIDAD_ATENCION_DESC == "Quemados *" ~ "15208__15208 - CONSULTA CIRUGÍA PLÁSTICA",
UNIDAD_ATENCION_DESC == "Salud Mental" ~ "15109__15109 - CONSULTA PSIQUIATRÍA",
UNIDAD_ATENCION_DESC == "Traumatologia Infantil" ~ "15316__15316 - CONSULTA TRAUMATOLOGÍA PEDIÁTRICA",
UNIDAD_ATENCION_DESC == "Urologia Infantil" ~ "15203__15203 - CONSULTA UROLOGÍA",
UNIDAD_ATENCION_DESC == "Reumatologia" ~ "15104__15104 - CONSULTA REUMATOLOGÍA",
UNIDAD_ATENCION_DESC == "Diabetes" ~ "15302__15302 - CONSULTA PEDIATRÍA GENERAL",
UNIDAD_ATENCION_DESC == "Hematologia Infantil" ~ "15135__15135 - CONSULTA HEMATOLOGÍA ONCOLÓGICA",
UNIDAD_ATENCION_DESC == "Oncologia Infantil" ~ "15135__15135 - CONSULTA HEMATOLOGÍA ONCOLÓGICA",
UNIDAD_ATENCION_DESC == "Maxilofacial" ~ "15302__15302 - CONSULTA PEDIATRÍA GENERAL",
UNIDAD_ATENCION_DESC == "Neurocirugia Infantil" ~ "15121__15121 - CONSULTA NEUROCIRUGÍA",
UNIDAD_ATENCION_DESC == "Prematuros *" ~ "15302__15302 - CONSULTA PEDIATRÍA GENERAL",
UNIDAD_ATENCION_DESC == "Cirugia Infantil" ~ "15409__15409 - CONSULTA CIRUGÍA PEDIÁTRICA",
UNIDAD_ATENCION_DESC == "Medicina fisica y rehabilitacion Infantil" ~ "15118__15118 - CONSULTA FISIATRÍA",
UNIDAD_ATENCION_DESC == "Hemofilia" ~ "15135__15135 - CONSULTA HEMATOLOGÍA ONCOLÓGICA",
TRUE ~ "Asignar Centro de Costo"),"Unidades de Producción" = "2__Atención", Valor=n)
No_asignadas_remotas <- At_remota %>% filter(`Centro de Producción`=="Asignar Centro de Costo")
At_remota$n <- NULL
At_remota$UNIDAD_ATENCION_DESC <- NULL
Produccion_SIGCOM<- rbind(Produccion_SIGCOM, At_remota)
Produccion_SIGCOM$Fecha <- NULL
openxlsx::write.xlsx(Produccion_SIGCOM,Graba,
colNames = TRUE, sheetName = "5", overwrite = TRUE)
Graba
Graba <- paste0("C:/Users/control.gestion3/OneDrive/BBDD Produccion/PERC/PERC ",anio ,"/",mes," ",mes_completo,"/Insumos de Informacion")
openxlsx::write.xlsx(Produccion_SIGCOM,Graba,
colNames = TRUE, sheetName = "5", overwrite = TRUE)
Graba <- paste0("C:/Users/control.gestion3/OneDrive/BBDD Produccion/PERC/PERC ",anio ,"/",mes," ",mes_completo,"/Insumos de Informacion/950_Produccion.xlsx")
openxlsx::write.xlsx(Produccion_SIGCOM,Graba,
colNames = TRUE, sheetName = "5", overwrite = TRUE)
# Librerias ---------------------------------------------------------------
library(tidyverse)
library(lubridate)
library(janitor)
library(dplyr)
Cubo_9 <- readxl::read_excel("C:/Users/control.gestion3/OneDrive/BBDD Produccion/PERC/Cubos 9/Cubo_9 BBDD.xlsx")
PM_GRD <- c(1.3239,	1.1900,	1.2501,	1.3399,	1.3454,	1.3679,	1.3505,	1.3420,	1.1704,	1.2395,	1.1703,1.2219,
1.2734,1.3280, 1.1678, 1.2583, 1.1628)
ambulatorio <- c(
"274-CONSULTA NEUROLOGÍA",
"275-CONSULTA REUMATOLOGÍA",
"276-CONSULTA CARDIOLOGÍA",
"277-CONSULTA DERMATOLOGÍA",
"278-CONSULTA ONCOLOGÍA",
"280-CONSULTA PSIQUIATRÍA",
"281-CONSULTA ENDOCRINOLOGÍA",
"282-CONSULTA NEUMOLOGÍA",
"284-CONSULTA INFECTOLOGÍA",
"285-CONSULTA NEFROLOGÍA",
"286-CONSULTA GENÉTICA",
"287-CONSULTA HEMATOLOGÍA",
"288-CONSULTA GERIATRÍA",
"289-CONSULTA FISIATRÍA",
"290-CONSULTA GASTROENTEROLOGÍA",
"292-CONSULTA NEUROCIRUGÍA",
"294-PROGRAMA MANEJO DEL DOLOR",
"295-CONSULTA SALUD OCUPACIONAL",
"296-CONSULTA ANESTESIOLOGIA",
"306-CONSULTA HEMATOLOGÍA ONCOLÓGICA",
"307-CONSULTA DE INMUNOLOGÍA",
"309-CONSULTA CIRUGÍA GENERAL",
"311-CONSULTA UROLOGÍA",
"316-CONSULTA CIRUGÍA PLÁSTICA",
"317-CONSULTA OFTALMOLOGÍA",
"318-CONSULTA CIRUGÍA VASCULAR PERIFÉRICA",
"319-CONSULTA OTORRINOLARINGOLOGÍA",
"323-CONSULTA CIRUGÍA MAXILOFACIAL",
"326-CONSULTA DE TRAUMATOLOGÍA",
"328-CONSULTA PEDIATRÍA GENERAL",
"329-CONSULTA NEONATOLOGÍA",
"331-CONSULTA NEUROLOGÍA PEDIÁTRICA",
"342-CONSULTA TRAUMATOLOGÍA PEDIÁTRICA",
"351-CONSULTA CIRUGÍA PEDIÁTRICA",
"353-CONSULTA GINECOLOGICA",
"354-CONSULTA OBSTETRICIA",
"230-CONSULTA NUTRICIÓN",
"15102-CONSULTA MEDICINA INTERNA",
"15103-CONSULTA NEUROLOGÍA",
"15104-CONSULTA REUMATOLOGÍA",
"15105-CONSULTA CARDIOLOGÍA",
"15106-CONSULTA DERMATOLOGÍA",
"15107-CONSULTA ONCOLOGÍA",
"15109-CONSULTA PSIQUIATRÍA",
"15110-CONSULTA ENDOCRINOLOGÍA",
"15111-CONSULTA NEUMOLOGÍA",
"15113-CONSULTA INFECTOLOGÍA",
"15114-CONSULTA NEFROLOGÍA",
"15115-CONSULTA GENÉTICA",
"15116-CONSULTA HEMATOLOGÍA",
"15117-CONSULTA GERIATRÍA",
"15118-CONSULTA FISIATRÍA",
"15119-CONSULTA GASTROENTEROLOGÍA",
"15121-CONSULTA NEUROCIRUGÍA",
"15124-CONSULTA SALUD OCUPACIONAL",
"15125-CONSULTA ANESTESIOLOGIA",
"15135-CONSULTA HEMATOLOGÍA ONCOLÓGICA",
"15136-CONSULTA DE INMUNOLOGÍA",
"15201-CONSULTA CIRUGÍA GENERAL",
"15203-CONSULTA UROLOGÍA",
"15208-CONSULTA CIRUGÍA PLÁSTICA",
"15209-CONSULTA OFTALMOLOGÍA",
"15210-CONSULTA CIRUGÍA VASCULAR PERIFÉRICA",
"15211-CONSULTA OTORRINOLARINGOLOGÍA",
"15215-CONSULTA CIRUGÍA MAXILOFACIAL",
"15218-CONSULTA DE TRAUMATOLOGÍA",
"15302-CONSULTA PEDIATRÍA GENERAL",
"15303-CONSULTA NEONATOLOGÍA",
"15305-CONSULTA NEUROLOGÍA PEDIÁTRICA",
"15316-CONSULTA TRAUMATOLOGÍA PEDIÁTRICA",
"15409-CONSULTA CIRUGÍA PEDIÁTRICA",
"15502-CONSULTA GINECOLOGICA",
"15503-CONSULTA OBSTETRICIA",
"15008-CONSULTA NUTRICIÓN"
)
cma <- c("465-QUIRÓFANO AMBULATORIO DE EMERGENCIA",
"471-QUIRÓFANOS MAYOR AMBULATORIA")
hospitalizacion <- c(
"65-HOSPITALIZACIÓN PENSIONADOS",
"66-HOSPITALIZACIÓN MEDICINA INTERNA",
"72-HOSPITALIZACIÓN NEUROLOGÍA",
"87-HOSPITALIZACIÓN ONCOLOGÍA",
"90-HOSPITALIZACIÓN QUIRÚRGICA",
"96-HOSPITALIZACIÓN UROLOGÍA",
"98-HOSPITALIZACIÓN NEUROCIRUGÍA",
"99-HOSPITALIZACIÓN OFTALMOLOGÍA",
"100-HOSPITALIZACIÓN OTORRINOLARINGOLOGÍA",
"111-HOSPITALIZACIÓN TRAUMATOLOGÍA",
"113-HOSPITALIZACIÓN OBSTETRICIA",
"114-HOSPITALIZACIÓN GINECOLOGÍA",
"116-HOSPITALIZACIÓN PEDIATRÍA",
"130-HOSPITALIZACIÓN TRAUMATOLOGÍA PEDIÁTRICA",
"136-HOSPITALIZACIÓN NEUROCIRUGÍA PEDIÁTRICA",
"149-HOSPITALIZACIÓN PSIQUIATRÍA")
hospitalizacion_uci <- c("166-UNIDAD DE CUIDADOS INTENSIVOS",
"169-UNIDAD DE CUIDADOS INTENSIVOS NEONATOS",
"170-UNIDAD DE CUIDADOS INTENSIVOS PEDIATRIA",
"180-UNIDAD DE CUIDADOS INTERMEDIOS ADULTOS",
"198-UNIDAD DE TRATAMIENTO INTENSIVO CORONARIOS",
"196-UNIDAD DE TRATAMIENTO INTENSIVO PEDÍATRICA",
"177-UNIDAD DE CUIDADOS CORONARIOS"
)
hospitalizacion_qx <- c(
"462-QUIRÓFANOS CABEZA Y CUELLO",
"464-QUIRÓFANOS CARDIOVASCULAR",
"467-QUIRÓFANOS DIGESTIVA",
"470-QUIRÓFANOS GINECOLOGÍA",
"475-QUIRÓFANOS NEUROCIRUGÍA",
"476-QUIRÓFANOS OBSTETRICIA",
"477-QUIRÓFANOS ODONTOLOGICA",
"478-QUIRÓFANOS OFTALMOLOGÍA",
"480-QUIRÓFANOS OTORRINOLARINGOLOGÍA",
"483-QUIRÓFANOS PROCTOLOGÍA",
"484-QUIRÓFANOS TORACICA",
"485-QUIRÓFANOS TRAUMATOLOGÍA Y ORTOPEDIA",
"486-QUIRÓFANOS UROLOGÍA",
"487-QUIRÓFANOS VASCULAR",
"493-QUIRÓFANOS CIRUGÍA PLÁSTICA",
"494-QUIRÓFANOS CIRUGÍA TORACICA",
"495-QUIRÓFANOS CIRUGÍA VASCULAR",
"797-QUIROFANOS CIRUGIA CARDIACA")
emergencias <- c("216-EMERGENCIAS PEDIÁTRICAS",
"357-EMERGENCIAS ODONTOLOGICAS")
# Urgencia ----------------------------------------------------------------
i4 <- Cubo_9 %>% filter(CC %in% emergencias & Item=="Total RRHH")  %>% group_by(Fecha) %>% summarise("Gasto RRHH 2021" = sum(total))
p4 <- Cubo_9 %>% filter(CC %in% emergencias & Item=="p1")  %>% group_by(Fecha) %>% summarise("Producción 2021" = sum(total))
i4 <- inner_join(i4,p4) %>%
mutate("Cod"=4, "Trazadora"="Atenciones de Emergencia", "Mes-Año"=Fecha, "Establecimiento"="HOSPITAL DE NIÑOS ROBERTO DEL RÍO",
"Código DEIS"="109101", "PM GRD 2021"="", "Gasto RRHH 2021"=`Gasto RRHH 2021`,"Producción 2021"=`Producción 2021`,"Costo por Actividad 2021"= round(`Gasto RRHH 2021`/`Producción 2021`)) %>%
select(Cod, Trazadora, `Mes-Año`, Establecimiento, `Código DEIS`, `PM GRD 2021`, `Gasto RRHH 2021`, `Producción 2021`,`Costo por Actividad 2021` )
# Ambulatorio -------------------------------------------------------------
i3 <- Cubo_9 %>% filter(CC %in% ambulatorio & Item=="Total RRHH")  %>% group_by(Fecha) %>% summarise("Gasto RRHH 2021" = sum(total))
p3 <- Cubo_9 %>% filter(CC %in% ambulatorio & Item=="p1")  %>% group_by(Fecha) %>% summarise("Producción 2021" = sum(total))
p33 <- Cubo_9 %>% filter(CC %in% ambulatorio & Item=="p3")  %>% group_by(Fecha) %>% summarise("Producción 2021" = sum(total))
p3 <- data.frame(Fecha=p3$Fecha, "Producción 2021"= p3$`Producción 2021`+p33$`Producción 2021`)
colnames(p3)[2] <- "Producción 2021"
i3 <- inner_join(i3,p3) %>%
mutate("Cod"=3, "Trazadora"="Consultas de Especialidad", "Mes-Año"=Fecha, "Establecimiento"="HOSPITAL DE NIÑOS ROBERTO DEL RÍO",
"Código DEIS"="109101", "PM GRD 2021"="", "Gasto RRHH 2021"=`Gasto RRHH 2021`,"Producción 2021"=`Producción 2021`,
"Costo por Actividad 2021"= round(`Gasto RRHH 2021`/`Producción 2021`)) %>%
select(Cod, Trazadora, `Mes-Año`, Establecimiento, `Código DEIS`, `PM GRD 2021`, `Gasto RRHH 2021`, `Producción 2021`,`Costo por Actividad 2021`)
# CMA ---------------------------------------------------------------------
i2 <- Cubo_9 %>% filter(CC %in% cma & Item=="Total RRHH")  %>% group_by(Fecha) %>% summarise("Gasto RRHH 2021" = sum(total))
p2 <- Cubo_9 %>% filter(CC %in% cma & Item=="p1")  %>% group_by(Fecha) %>% summarise("Producción 2021" = sum(total))
i2 <- inner_join(i2,p2) %>%
mutate("Cod"=2, "Trazadora"="Cirugía Mayor Ambulatoria", "Mes-Año"=Fecha, "Establecimiento"="HOSPITAL DE NIÑOS ROBERTO DEL RÍO",
"Código DEIS"="109101", "PM GRD 2021"="", "Gasto RRHH 2021"=`Gasto RRHH 2021`,"Producción 2021"=`Producción 2021`,
"Costo por Actividad 2021"= round(`Gasto RRHH 2021`/`Producción 2021`)) %>%
select(Cod, Trazadora, `Mes-Año`, Establecimiento, `Código DEIS`, `PM GRD 2021`, `Gasto RRHH 2021`, `Producción 2021`,`Costo por Actividad 2021`)
# Hospitalizado -----------------------------------------------------------
i1 <- Cubo_9 %>% filter((CC %in% hospitalizacion | CC %in% hospitalizacion_qx | CC %in% hospitalizacion_uci) & Item=="Total RRHH")  %>%
group_by(Fecha) %>% summarise("Gasto RRHH 2021" = sum(total))
p1 <- Cubo_9 %>% filter(CC %in% hospitalizacion & Item=="p1")  %>% group_by(Fecha) %>% summarise("Producción 2021" = sum(total))
p11 <-  Cubo_9 %>% filter(CC %in% hospitalizacion_uci & Item=="p3")  %>% group_by(Fecha) %>% summarise("Producción 2021" = sum(total))
p1 <- data.frame(Fecha=p1$Fecha, "Producción 2021"= p1$`Producción 2021`+p11$`Producción 2021`)
colnames(p1)[2] <- "Producción 2021"
i1 <- inner_join(i1,p1) %>%
mutate("Cod"=1, "Trazadora"="Hospitalización", "Mes-Año"=Fecha, "Establecimiento"="HOSPITAL DE NIÑOS ROBERTO DEL RÍO",
"Código DEIS"="109101", "PM GRD 2021"= PM_GRD, "Gasto RRHH 2021"=`Gasto RRHH 2021`,"Producción 2021"=`Producción 2021`,
"Costo por Actividad 2021"= round((`Gasto RRHH 2021`/(`Producción 2021`*PM_GRD)))) %>%
select(Cod, Trazadora, `Mes-Año`, Establecimiento, `Código DEIS`, `PM GRD 2021`, `Gasto RRHH 2021`, `Producción 2021`,`Costo por Actividad 2021`)
View(i1)
View(i2)
View(i2)
View(i3)
View(i4)
View(i3)
View(i1)
informe <- rbind(i1, i3, i2, i4)
openxlsx::write.xlsx(informe,paste0(ruta_base,"C:/Users/control.gestion3/OneDrive/BBDD Produccion/PERC/Cubos 9/informe_mensual.xlsx"),
colNames = TRUE, sheetName = "Informe", overwrite = TRUE)
openxlsx::write.xlsx(informe,"C:/Users/control.gestion3/OneDrive/BBDD Produccion/PERC/Cubos 9/informe_mensual.xlsx",
colNames = TRUE, sheetName = "Informe", overwrite = TRUE)
View(informe)
informe$`Mes-Año` <- as.Date(informe$`Mes-Año`)
openxlsx::write.xlsx(informe,"C:/Users/control.gestion3/OneDrive/BBDD Produccion/PERC/Cubos 9/informe_mensual.xlsx",
colNames = TRUE, sheetName = "Informe", overwrite = TRUE)
